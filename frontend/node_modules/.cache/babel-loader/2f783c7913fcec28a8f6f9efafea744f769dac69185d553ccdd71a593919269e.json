{"ast":null,"code":"import React,{useEffect}from\"react\";import{BrowserRouter as Router,Routes,Route,Navigate,useNavigate}from\"react-router-dom\";import Home from\"./pages/Home\";import Login from\"./pages/Login\";import{useMsal}from\"@azure/msal-react\";import{InteractionStatus}from\"@azure/msal-browser\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{element}=_ref;const{accounts,inProgress}=useMsal();// If authentication is in progress, wait\nif(inProgress===InteractionStatus.Startup||inProgress===InteractionStatus.HandleRedirect){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});// Show a loading screen while handling login\n}// Redirect to login if not authenticated\nreturn accounts.length>0?element:/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});};const LoginRedirectHandler=()=>{const{accounts}=useMsal();const navigate=useNavigate();useEffect(()=>{const fetchUserID=async()=>{if(accounts.length>0){const user=accounts[0];try{const response=await axios.post(\"https://bytepantry-api-hjbkd7hxfbasg7h8.canadacentral-01.azurewebsites.net/auth/b2c-login\",{email:user.username,name:user.name});if(response.data.userID){localStorage.setItem(\"userID\",response.data.userID);navigate(\"/home\");// Redirect user to home page after login\n}}catch(error){console.error(\"❌ Error retrieving userID:\",error);}}};fetchUserID();},[accounts,navigate]);return/*#__PURE__*/_jsx(\"div\",{children:\"Redirecting...\"});// Temporary UI while redirecting\n};const App=()=>{return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(ProtectedRoute,{element:/*#__PURE__*/_jsx(Home,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(ProtectedRoute,{element:/*#__PURE__*/_jsx(Home,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/authentication/login-callback\",element:/*#__PURE__*/_jsx(LoginRedirectHandler,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})});};export default App;","map":{"version":3,"names":["React","useEffect","BrowserRouter","Router","Routes","Route","Navigate","useNavigate","Home","Login","useMsal","InteractionStatus","axios","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","element","accounts","inProgress","Startup","HandleRedirect","children","length","to","LoginRedirectHandler","navigate","fetchUserID","user","response","post","email","username","name","data","userID","localStorage","setItem","error","console","App","path"],"sources":["C:/bytepantry/frontend/src/App.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { BrowserRouter as Router, Routes, Route, Navigate, useNavigate } from \"react-router-dom\";\r\nimport Home from \"./pages/Home\";\r\nimport Login from \"./pages/Login\";\r\nimport { useMsal } from \"@azure/msal-react\";\r\nimport { InteractionStatus } from \"@azure/msal-browser\";\r\nimport axios from \"axios\";\r\n\r\nconst ProtectedRoute = ({ element }) => {\r\n  const { accounts, inProgress } = useMsal();\r\n\r\n  // If authentication is in progress, wait\r\n  if (inProgress === InteractionStatus.Startup || inProgress === InteractionStatus.HandleRedirect) {\r\n    return <div>Loading...</div>; // Show a loading screen while handling login\r\n  }\r\n\r\n  // Redirect to login if not authenticated\r\n  return accounts.length > 0 ? element : <Navigate to=\"/login\" />;\r\n};\r\n\r\nconst LoginRedirectHandler = () => {\r\n  const { accounts } = useMsal();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchUserID = async () => {\r\n      if (accounts.length > 0) {\r\n        const user = accounts[0];\r\n        try {\r\n          const response = await axios.post(\r\n            \"https://bytepantry-api-hjbkd7hxfbasg7h8.canadacentral-01.azurewebsites.net/auth/b2c-login\",\r\n            { email: user.username, name: user.name }\r\n          );\r\n\r\n          if (response.data.userID) {\r\n            localStorage.setItem(\"userID\", response.data.userID);\r\n            navigate(\"/home\"); // Redirect user to home page after login\r\n          }\r\n        } catch (error) {\r\n          console.error(\"❌ Error retrieving userID:\", error);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchUserID();\r\n  }, [accounts, navigate]);\r\n\r\n  return <div>Redirecting...</div>; // Temporary UI while redirecting\r\n};\r\n\r\nconst App = () => {\r\n  return (\r\n    <Router>\r\n      <Routes>\r\n        <Route path=\"/\" element={<ProtectedRoute element={<Home />} />} />\r\n        <Route path=\"/home\" element={<ProtectedRoute element={<Home />} />} />\r\n        <Route path=\"/login\" element={<Login />} />\r\n        <Route path=\"/authentication/login-callback\" element={<LoginRedirectHandler />} />\r\n        <Route path=\"*\" element={<Navigate to=\"/\" />} />\r\n      </Routes>\r\n    </Router>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,OAASC,aAAa,GAAI,CAAAC,MAAM,CAAEC,MAAM,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CAChG,MAAO,CAAAC,IAAI,KAAM,cAAc,CAC/B,MAAO,CAAAC,KAAK,KAAM,eAAe,CACjC,OAASC,OAAO,KAAQ,mBAAmB,CAC3C,OAASC,iBAAiB,KAAQ,qBAAqB,CACvD,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAiB,IAAhB,CAAEC,OAAQ,CAAC,CAAAD,IAAA,CACjC,KAAM,CAAEE,QAAQ,CAAEC,UAAW,CAAC,CAAGX,OAAO,CAAC,CAAC,CAE1C;AACA,GAAIW,UAAU,GAAKV,iBAAiB,CAACW,OAAO,EAAID,UAAU,GAAKV,iBAAiB,CAACY,cAAc,CAAE,CAC/F,mBAAOT,IAAA,QAAAU,QAAA,CAAK,YAAU,CAAK,CAAC,CAAE;AAChC,CAEA;AACA,MAAO,CAAAJ,QAAQ,CAACK,MAAM,CAAG,CAAC,CAAGN,OAAO,cAAGL,IAAA,CAACR,QAAQ,EAACoB,EAAE,CAAC,QAAQ,CAAE,CAAC,CACjE,CAAC,CAED,KAAM,CAAAC,oBAAoB,CAAGA,CAAA,GAAM,CACjC,KAAM,CAAEP,QAAS,CAAC,CAAGV,OAAO,CAAC,CAAC,CAC9B,KAAM,CAAAkB,QAAQ,CAAGrB,WAAW,CAAC,CAAC,CAE9BN,SAAS,CAAC,IAAM,CACd,KAAM,CAAA4B,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAIT,QAAQ,CAACK,MAAM,CAAG,CAAC,CAAE,CACvB,KAAM,CAAAK,IAAI,CAAGV,QAAQ,CAAC,CAAC,CAAC,CACxB,GAAI,CACF,KAAM,CAAAW,QAAQ,CAAG,KAAM,CAAAnB,KAAK,CAACoB,IAAI,CAC/B,2FAA2F,CAC3F,CAAEC,KAAK,CAAEH,IAAI,CAACI,QAAQ,CAAEC,IAAI,CAAEL,IAAI,CAACK,IAAK,CAC1C,CAAC,CAED,GAAIJ,QAAQ,CAACK,IAAI,CAACC,MAAM,CAAE,CACxBC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAER,QAAQ,CAACK,IAAI,CAACC,MAAM,CAAC,CACpDT,QAAQ,CAAC,OAAO,CAAC,CAAE;AACrB,CACF,CAAE,MAAOY,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CACpD,CACF,CACF,CAAC,CAEDX,WAAW,CAAC,CAAC,CACf,CAAC,CAAE,CAACT,QAAQ,CAAEQ,QAAQ,CAAC,CAAC,CAExB,mBAAOd,IAAA,QAAAU,QAAA,CAAK,gBAAc,CAAK,CAAC,CAAE;AACpC,CAAC,CAED,KAAM,CAAAkB,GAAG,CAAGA,CAAA,GAAM,CAChB,mBACE5B,IAAA,CAACX,MAAM,EAAAqB,QAAA,cACLR,KAAA,CAACZ,MAAM,EAAAoB,QAAA,eACLV,IAAA,CAACT,KAAK,EAACsC,IAAI,CAAC,GAAG,CAACxB,OAAO,cAAEL,IAAA,CAACG,cAAc,EAACE,OAAO,cAAEL,IAAA,CAACN,IAAI,GAAE,CAAE,CAAE,CAAE,CAAE,CAAC,cAClEM,IAAA,CAACT,KAAK,EAACsC,IAAI,CAAC,OAAO,CAACxB,OAAO,cAAEL,IAAA,CAACG,cAAc,EAACE,OAAO,cAAEL,IAAA,CAACN,IAAI,GAAE,CAAE,CAAE,CAAE,CAAE,CAAC,cACtEM,IAAA,CAACT,KAAK,EAACsC,IAAI,CAAC,QAAQ,CAACxB,OAAO,cAAEL,IAAA,CAACL,KAAK,GAAE,CAAE,CAAE,CAAC,cAC3CK,IAAA,CAACT,KAAK,EAACsC,IAAI,CAAC,gCAAgC,CAACxB,OAAO,cAAEL,IAAA,CAACa,oBAAoB,GAAE,CAAE,CAAE,CAAC,cAClFb,IAAA,CAACT,KAAK,EAACsC,IAAI,CAAC,GAAG,CAACxB,OAAO,cAAEL,IAAA,CAACR,QAAQ,EAACoB,EAAE,CAAC,GAAG,CAAE,CAAE,CAAE,CAAC,EAC1C,CAAC,CACH,CAAC,CAEb,CAAC,CAED,cAAe,CAAAgB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}